The implementation code and the book differ quite b bit. I think I got a draft version of the book files...

